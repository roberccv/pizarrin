<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Solicitudes</title>
    <link rel="stylesheet" href="stylesheets/pizarrin.css">
</head>
<body>
<div class="browser-header">
    <div class="menu-icon">&#9776;</div>
    <div class="search-container">
        <input type="text" placeholder="Search">
        <button>üîç</button>
    </div>
    <div class="profile-icon">üë§</div>
</div>

<div class="solicitudes-container">
    <h1>SOLICITUDES</h1>
    <div class="solicitudes-columns">
        <!-- Secci√≥n de alumnos -->
        <div class="column">
            <h2>ALUMNOS:</h2>
            <% solicitudes.filter(s => s.rol !== 2).forEach(solicitud => { %>
            <div class="solicitud-item">
                <p><%= solicitud.name %> (<%= solicitud.email %>). Estudia <%= solicitud.carrera%></p>
                <button class="accept" onclick="aceptarSolicitud(<%= solicitud.id %>)">‚úîÔ∏è</button>
                <button class="deny" onclick="rechazarSolicitud(<%= solicitud.id %>)">‚ùå</button>
            </div>
            <% }) %>
        </div>

        <!-- Secci√≥n de profesores -->
        <div class="column">
            <h2>PROFESORES:</h2>
            <% solicitudes.filter(s => s.rol === 2).forEach(solicitud => { %>
            <div class="solicitud-item">
                <p><%= solicitud.name %> (<%= solicitud.email %>)</p>
                <button class="accept" onclick="aceptarSolicitud(<%= solicitud.id %>)">‚úîÔ∏è</button>
                <button class="deny" onclick="rechazarSolicitud(<%= solicitud.id %>)">‚ùå</button>
            </div>
            <% }) %>
        </div>
    </div>
    <button class="volver-button" onclick="window.location.href='07-administrador.html'">Volver</button>
</div>

<script>
    // Funci√≥n para aceptar una solicitud
    async function aceptarSolicitud(id) {
        try {
            const response = await fetch('/aceptar-solicitud', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ id })
            });

            if (response.ok) {
                alert('Solicitud aceptada con √©xito');
                location.reload();
            } else {
                alert('Error al aceptar la solicitud');
            }
        } catch (error) {
            console.error('Error al aceptar la solicitud:', error);
        }
    }

    // Funci√≥n para rechazar una solicitud
    async function rechazarSolicitud(id) {
        try {
            const response = await fetch('/rechazar-solicitud', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ id })
            });

            if (response.ok) {
                alert('Solicitud rechazada con √©xito');
                location.reload();
            } else {
                alert('Error al rechazar la solicitud');
            }
        } catch (error) {
            console.error('Error al rechazar la solicitud:', error);
        }
    }
</script>
</body>
</html>
